## 원격 제어가능한 자원 조사
- 라즈베리 파이를 이용한 모듈?
  - ex) 서보 모터(도어락 대용), LED (전등 대용) etc..

기존에 판매중인 IoT 기기들은 각자의 어플을 통해 독자적으로 제어되고 있기 때문에,
따로 서버에서 제어하는 데 어려움이 있다.  
이 때문에 라즈베리 파이에 모듈을 연결해 대체한다.

### 고려해야 할 점
1. 서버에서 해당 기기에 어떻게 명령을 내릴 것인가?
- Polling?
  - 라즈베리 파이에서 서버로 계속해서 요청 메시지를 보내고, 서버에서 동작 명령을 응답으로 주는 방식
  - 시나리오
     1. 리소스는 서버로 계속해서 Get 요청을 보내 동작 여부를 체크한다
     2. 클라이언트가 권한을 가진 리소스의 범위 내로 진입한다
     3. 클라이언트에게 Push 알림으로 리소스 사용 여부를 묻는다
     4. 클라이언트가 사용 버튼을 클릭하면, 계속 보내왔던 리소스의 Get 요청에 허가 응답으로 답장한다
     5. 리소스가 동작하고, 클라이언트가 사용 취소 버튼을 누르거나 해당 위치에서 벗어나면 리소스의 Get 요청에 불가 응답으로 답장한다
- Socket 통신?
  - 라즈베리 파이와 서버간에 소켓통신을 하여 명령을 내리는 방식

## 사용자 인증 방식 아이디어
### 1. OTP(One Time Password)
서버에서 일회용 비밀번호를 생성해 제공하는 서비스이다.  
보통 사용자가 보유하고 있는 스마트폰과 같은 기기를 통해 비밀번호가 제공된다.  
그렇기 때문에 등록된 기기에 대한 소유권자만이 입력을 통해 인증을 할 수 있다.  
해당 비밀번호를 특정 시간 안에 서버에 입력하면, 일치 여부를 통해 인증을 진행한다.  
꽤 간단하고 효율적인 방식이기 때문에, 대부분의 인증 절차에서 채택하고 있다.  

비밀번호 생성 방식으로는 아래와 같은 방식들이 사용된다.  
  - HOTP(HMAC-based OTP)
    - HMAC은 Hash-based Message Authentication Code를 의미한다.
    - HOTP는 Message가 아닌 Counter를 기반으로 암호를 생성한다.
    - 암호화에 해시 함수인 SHA-XXX 함수가 사용된다.
    - 결과로 6자리의 임의의 정수를 반환하게 된다.
  - TOTP(Time-based OTP)
    - 위의 HOTP를 기본 아이디어로, Counter 대신에 Timestamp를 기반으로 암호를 생성한다.
    - 위와 동일하게 SHA-XXX 함수가 암호화에 사용된다.
    - 위와 동일하게 결과로 6자리의 임의 정수를 반환한다.

OTP 방식은 반드시 사용할 계획이나, 비밀번호 생성 방식을 결정하는 것이 관건이다.  
아래와 같은 방식을 제안한다.  
- Java의 Random class를 사용해 난수를 발생시킨다.
- 하지만 Random은 pseudo random이므로, trick을 이용하자
  - Random하게 고정된 자릿 수의 난수를 생성한다. (ex) 15자리)
  - 해당 수안에서, 다시 Random하게 6개의 자리를 골라 6자리의 수를 만든다.

### 2. 개인 QR 코드 발급?
권한을 교수와 학생으로 나눈다고 가정을 했을 때, 그 권한을 어떻게 구분할 것인가?  
간단히 교수들에게는 개인적으로 교수 전용 QR 코드를 발급해주고, 인증 시 해당 코드를 입력하는 건?  
원래 ID, PW는 지식 기반이지만 해당 정보를 바탕으로 소유 기반의 인증 방식으로 전환한 것이다.  

아래와 같은 시나리오를 생각해보았다.
  1. 교수는 최초 회원가입 시, 관리자에게서 QR 코드를 발급 받아야 한다.
  2. 해당 QR 코드를 카메라로 찍으면, 코드가 텍스트로 나오며 복사가 가능하다.
    - 코드는 관리자가 교수가 가입한 비밀번호를 기반으로 생성한다.
    - 물론 해당 비밀번호는 DB에서 BEncrypt를 통해 암호화 된 문자열이며, 복호화가 불가능해야 한다.
    - 코드는 해당 비밀번호를 한번 더 Encrypt한 코드이면 어떨까?
  3. 교수도 OTP를 사용해야 하기에, "OTP+해당 코드"를 동시에 입력받아 검증하게 하면 어떨까?
    - 단, 모든 코드는 동일한 길이의 자릿수를 가져야한다.
    - 대신 해당 코드 중 Random한 4자리를 뽑아 해당 자리에 맞게 값이 들어왔는지 검증한다.
    - 은행에서 사용하는 보안코드와 같은 원리.

아래와 같은 문제점들이 예상된다.
- QR 코드 분실 시 인증이 불가능하다.
  - QR 코드 도난 시 보안이 뚫리게 되는 것이다.
- 해당 QR에 대한 정보는 DB에서 보관해야 하기에, 탈취의 위험이 있다.
  - 복호화가 가능하다면, 바로 개인 정보가 위협을 받을 것이다.
- 사용자에게 있어서 편의성이 떨어진다.

### 3. 관리자 인증은?
관리자 페이지 경로는 외부로 공개되지 않도록 한다.  
관리자 페이지에서 따로 관리자 아이디를 통해 로그인 하도록 한다.  
관리자의 아이디 / 비밀번호 또한 대외비로 외부로 공개되어선 안된다.  

### 결과 시나리오
<img width="506" alt="스크린샷 2023-05-19 오후 6 09 45" src="https://github.com/Jinseop-Sim/Graduation-Project/assets/71700079/ce95e8e6-9545-410e-bd94-2c45e5959dae">  
